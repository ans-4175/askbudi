<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google" value="notranslate">

    <title>Anda Bertanya Budi Menjawab</title>

    <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootcards CSS files for desktop, iOS and Android -->
    <!-- You'll only need to load one of these (depending on the device you're using) in production -->
    <!-- <link href="http://cdnjs.cloudflare.com/ajax/libs/bootcards/1.1.1/css/bootcards-ios.min.css" rel="stylesheet"> -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/bootcards/1.1.1/css/bootcards-desktop.min.css" rel="stylesheet">
    <!-- <link href="http://cdnjs.cloudflare.com/ajax/libs/bootcards/1.1.1/css/bootcards-android.min.css" rel="stylesheet"> -->
    <!-- Font awesome -->
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />

</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-7 bootcards-cards hidden-xs">
                <div class="panel panel-default bootcards-richtext">
                    <div class="panel-heading">
                        <h3 class="panel-title">About Budi</h3>
                    </div>
                    <div class="panel-body" id="stream_app">
                        <p>Budi, the question-answering bot, is your best friend.</p>
                        <ul>
                            <li>Ask your question via <a href="http://twitter.com" target="_blank">twitter</a>.</li>
                            <li>Ask your question via .</li>
                        </ul>
                        <p>
                            This is only a sample page: it is not meant to be fully functional. We've used <a href="http://fortawesome.github.io/Font-Awesome/" target="_blank">Font Awesome</a> for the icons and have include FTLabs' <a href="https://github.com/ftlabs/fastclick" target="_blank">FastClick</a> library to make tapping links on iOS faster.
                        </p>
                    </div>
                    <div class="panel-footer">
                        <small class="pull-left">Built with NodeJS + SocketIO + Twitter API + Wikimedia API</small>
                        <a class="btn btn-link btn-xs pull-right" href="#">askbudi.pandu.ml</a>
                    </div>
                </div>
            </div>
            <div class="col-sm-5 bootcards-list" id="list">
                <div class="panel panel-default">    
                    <div class="panel-heading clearfix">
                        <h3 class="panel-title pull-left">Ask Me Anything!</h3>
                        <div class="btn-group pull-right">
                            <a class="btn btn-primary" href="http://www.twitter.com" target="_blank">
                                <i class="fa fa-plus"></i>
                                <span>tweet</span>
                            </a>
                        </div>      
                    </div>
                    <div class="list-group" id="stream_list" >
                        <!-- CONTENT -->
                    </div>
                    <div class="panel-footer">
                        <small class="pull-left">#askbudi live stream</small>
                        <a class="btn btn-link btn-xs pull-right" href="http://www.twitter.com/tampanberiman" target="_blank">@tampanberiman</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>

    <script>
        var socket = io('http://ssh.pandu.ml:8080');
        // var socket = io('http://localhost:8080');
    </script>

    <script type="text/jsx">

        var StreamCard = React.createClass({
            render: function () {
                var stream = this.props.stream;
                return (
                    <a className="list-group-item" href="#">
                        <img src={stream.avatar} className="img-rounded pull-left"/>
                        <h4 className="list-group-item-heading">{stream.author}</h4>
                        <p className="list-group-item-text">{stream.body}</p>
                    </a>
                );
            }
        });

        var StreamList = React.createClass({
            getInitialState: function () {
                return {streams: []};
            },
            componentDidMount: function () {
                socket.on('frontend:init', this._initialize);
                socket.on('frontend:list', this._list);
            },
            _initialize: function (streams) {
                this.setState({streams: streams});
                console.log(this.state.streams);
            },
            _list: function (stream) {
                var streams = this.state.streams;
                var newStreams = [stream].concat(streams);
                this.setState({streams: newStreams});
            },
            render: function () {
                var streamCards = this.state.streams.map(function (stream) {
                    return (
                        <StreamCard stream={stream}></StreamCard>
                    );
                });
                return (
                    <div>{streamCards}</div>
                );
            }
        });

        React.render(
            <StreamList />,
            document.getElementById('stream_list')
        );
        
    </script>

</body>
</html>
